# 실행 컨텍스트

## 소스코드의 타입

- 전역 코드: 전역에 존재하는 소스코드
- 함수 코드: 함수 내부의 소스코드
- eval 코드: eval 함수에 인수로 전달되어 실행되는 소스코드
- 모듈 코드: 모듈 내부에 존재하는 소스코드

## 소스코드의 평가와 실행

### 소스코드 평가

1. 실행 컨텍스트 생성
2. 변수, 함수 등의 선언문 실행
3. 생성된 변수나 함수 식별자를 키로 실행 컨텍스트가 관리하는 스코프에 등록

### 소스코드 실행

1. 런타임 시작
2. 소스코드 실행에 필요한 정보(변수나 함수의 참조)를 실행 컨텍스트가 관리하는 스코프에서 취득
3. 변수 값의 변경 등 소스코드 실행 결과를 다시 실행 컨텍스트가 관리하는 스코프에 등록

## 실행 컨텍스트의 역할

- 소스코드를 실행하는 데 필요한 환경을 제공하고 코드의 실행 결과를 실제로 관리하는 영역
- 식별자와 스코프는 실행 컨텍스트의 렉시컬 환경으로 관리
- 코드 실행 순서는 실행 컨텍스트 스택으로 관리

## 실행 컨텍스트 스택

```js
const x = 1;

function foo() {
  const y = 2;

  function bar() {
    const z = 3;
    console.log(x + y + z);
  }
  bar();
}

foo(); // 6
```

- 실행 컨텍스트는 스택 자료구조로 관리됨

|     |                    |                       |   실행 컨텍스트 스택   |                        |                    |     |
| :-: | :----------------: | :-------------------: | :--------------------: | :--------------------: | :----------------: | :-: |
|     |                    |                       | bar 함수 실행 컨텍스트 |                        |                    |     |
|     |                    | foo함수 실행 컨텍스트 | foo 함수 실행 컨텍스트 | foo 함수 실행 컨텍스트 |                    |     |
|     | 전역 실행 컨텍스트 |  전역 실행 컨텍스트   |   전역 실행 컨텍스트   |   전역 실행 컨텍스트   | 전역 실행 컨텍스트 |     |

1. 전역 코드 평가와 실행
2. foo 함수 코드의 평가와 실행
3. bar 함수 코드의 평가와 실행
4. foo 함수 코드로 복귀
5. 전역 코드로 복귀

- 실행 컨텍스트 스택의 최상위에 존재하는 실행 컨텍스트는 언제나 현재 실행 중인 코드의 실행 컨텍스트임
- 이를 실행 중인 실행 컨텍스트라 부름

## 렉시컬 환경

- 식별자와 식별자에 바인딩된 값, 상위 스코프에 대한 참조를 기록하는 자료구조
- 렉시컬 환경은 환경 레코드와 외부 렉시컬 환경에 대한 참조라는 컴포넌트로 구성됨
