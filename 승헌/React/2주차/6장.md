## 6장 라이프 사이클과 리액트 개발자 도구

---

## 리액트 컴포넌트의 라이프 사이클

리액트 컴포넌트의 라이프 사이클은 크게 3단계로 구분한다.

- 마운트 : 컴포넌트를 페이지에 처음 렌더링할 때
- 업데이트 : State나 Props의 값이 바뀌거나 부모 컴포넌트가 리렌더해 자신도 리렌더될 때
- 언마운트 : 더 이상 페이지에 컴포넌트를 렌더링하지 않을 때

라이프 사이클을 이용하면 컴포넌트가 처음 렌더링될 때 특정 동작을 하도록 만들거나, 업데이트, 메모리 정리 등 유용한 작업을 단계에 맞게 할 수 있다. 이를 라이프 사이클 제어라고 한다. 리액트 훅의 하나인 함수 useEffect를 이용하면 이 사이클을 쉽게 제어할 수 있다.

**useEffect**

함수 useEffect는 어떤 값이 변경될 때마다 특정 코드를 실행하는 리액트 훅이다. 이를 특정 값을 검사한다고 표현한다. `useEffect(callback, [deps])`

두 번째 인수로 전달한 배열을 의존성 배열이라고 하는데, useEffect는 이 배열 요소의 값이 변경되면 첫 번째 인수로 전달한 콜백 함수를 실행한다. useEffect를 이용하면 특정 값이 바뀔 때마다 원하는 코드를 실행하게 만들 수 있다.

**여러 개의 값 검사하기**

useEffect의 의존성 배열 요소가 여러 개 있어도 마찬가지다. 즉, 배열 요소 중 하나가 변경되어도 useEffect는 콜백 함수를 실행한다.

**useEffect로 라이프 사이클 제어하기**

두 번째 요소인 의존성 배열에 아무것도 전달하지 않으면, useEffect는 컴포넌트를 렌더링할 때마다 콜백 함수를 실행한다.

```jsx
useEffect(() => {
  console.log("컴포넌트 업데이트");
});
```

정리하면 useEffect에서 의존성 배열을 인수로 전달하지 않으면 마운트, 업데이트 시점 모두 콜백 함수로 호출한다. 그러나 콜백 함수 내부에서 조건문과 Ref 객체로 특정 시점에만 코드를 실행하게 만들 수 있다

```jsx
useEffect(() => {
  if (!didMountRef.current) {
    didMountRef.current = true;
    return;
  } else {
    console.log("Component updated");
  }
});
```

**컴포넌트의 마운트 제어하기**

useEffect 의존성 배열에 빈 배열을 전달하면 컴포넌트의 마운트 시점에만 콜백 함수를 실행한다.

```jsx
useEffect(() => {
  console.log("Component mounted");
}, []);
```

**컴포넌트 언마운트 제어하기**

리액트 컴포넌트의 언마운트 시점을 제어하기 위해서는 먼저 클린업 기능을 이해해야 하며, 프로그래밍에서 이 개념은 특정 함수가 실행되고 종료된 후에, 미처 정리하지 못한 사항을 처리하는 일이다.

```jsx
useEffect(() => {
  const IntervalID = setInterval(() => {
    console.log("깜빡");
  }, 1000);

  return () => {
    console.log("cleanup");
    clearInterval(IntervalID);
  };
});
```

setinterval은 자바스크립트 내장 함수로 두 번째 인수인 밀리초 시간이 경과하면 첫 번째 인수로 전달할 콜백 함수를 실행하는 인터벌(시간간격을) 설정하는 함수다. clearInterval이라는 또 다른 내장 함수를 호출하지 않으면 문자열 출력은 멈추지 않는다.

정리하면 useEffect의 콜백 함수가 반환하는 함수를 클린업 함수라고 한다. 이 함수는 콜백 함수를 다시 호출하기 전에 실행된다. 따라서 컴포넌트를 렌더링할 때마다 새 인터벌을 생성하고 기존 인터벌을 삭제한다.

**클린업을 이용해 컴포넌트 언마운트 제어하기**

함수 useEffect에 의존성 배열로 빈 배열을 전달하고, 콜백 함수가 함수를 반환하면 이 함수는 컴포넌트의 언마운트 시점에 실행된다.

```jsx
import { useEffect } from "react";

function Even() {
  useEffect(() => {
    return () => {
      console.log("짝수 컴포넌트가 언마운트 되었습니다.");
    };
  }, []);
  return <div>현재 카운트는 짝수다.</div>;
}

export default Even;
```
